*** Settings ***
Library           Selenium2Library
Variables         Variables/values/form.py
Resource          其他.txt

*** Keywords ***
事项数据录入
    Sleep    5
    Select Frame    iframe2
    Select Frame    handleFrameId
    Wait Until Page Contains Element    //span[@id='sqrzjhm']/span/input
    Input Text    //span[@id='sqrzjhm']/span/input    ${value}
    Input Text    sqrmc$value    ${value}
    ${sqrmc1}    Get Value    //input[@id='sqrmc$value']
    Set Global Variable    ${sqrmc}    ${sqrmc1}
    Input Text    lxrxm$value    ${value}
    Input Text    lxrsj$value    18819153582
    Input Text    text2$value    ${value}
    Input Text    text3$value    ${value}
    Input Text    text15$value    ${value}
    Click Link    btnSubmit
    Choose Ok On Next Confirmation
    Confirm Action

补正告知
    Select Window    珠海市网上办事系统
    Select Frame    iframe2
    Wait Until Element Is Visible    supplementBtn
    Click Link    supplementBtn
    Select Frame    handleFrameName
    Wait Until Element Is Visible    bzgzyy$value
    ${currenttime}    Evaluate    time.strftime('%Y%m%d%H%M%S')    time
    Input Text    bzgzyy$value    补正告知原因${currenttime}
    ${countrow1}    Get Matching Xpath Count    //div/table/tbody/tr
    ${countrow}    Evaluate    random.randint(3,${countrow1}-5)    random
    Select Frame    repaireList
    Select Checkbox    //div/table/tbody/tr[${countrow}]/td[4]/div/input
    Select Window    珠海市网上办事系统
    Select Frame    iframe2
    Select Frame    handleFrameName
    sleep    2
    Click Link    btnAdd
    sleep    1

点击[处理]
    Wait Until Element Is Visible    receiveAndDo
    Click Link    receiveAndDo
    comment    ${a}    判断页面是否加载完成
    comment    Should Be True    ${a}==1
    Select Frame    handleFrameName
    sleep    2
    Click link    btnAdd
    sleep    1

提示窗口确认
    Choose Ok On Next Confirmation
    Confirm Action

关闭弹窗
    [Arguments]    ${title}
    [Documentation]    *input the popup window title
    Select Window    ${title}
    Title Should Be    ${title}
    sleep    3
    Close Window

延期申请

特别程序申请
